
<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ç™¾å®¶æ¨‚ AI é æ¸¬</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .btn { padding: 10px 20px; margin: 5px; font-size: 16px; }
    #chart-container { width: 100%; max-width: 500px; margin-top: 20px; }
    #history-list { margin-top: 20px; }
    .history-item { padding: 4px 0; }
  </style>
</head>
<body>
  <h2>ç™¾å®¶æ¨‚é æ¸¬å·¥å…·ï¼ˆAIç‰ˆï¼‰</h2>
  <p id="stats">å‹ç‡ï¼šèŠ 0% | é–’ 0%</p>
  <p id="suggestion">å»ºè­°ï¼šè«‹è¼¸å…¥çµæœ</p>
  <p id="ai-predict">AI é æ¸¬ï¼šç„¡</p>
  <p id="streak"></p>

  <button class="btn" onclick="addResult('B')">è¼¸å…¥èŠ</button>
  <button class="btn" onclick="addResult('P')">è¼¸å…¥é–’</button>
  <button class="btn" onclick="clearHistory()">æ¸…é™¤ç´€éŒ„</button>

  <div id="chart-container">
    <canvas id="resultChart"></canvas>
  </div>

  <div id="history-list">
    <h3>æ­·å²ç´€éŒ„</h3>
    <div id="record-list"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let history = JSON.parse(localStorage.getItem("baccarat_history") || "[]");

    function addResult(result) {
      history.push(result);
      localStorage.setItem("baccarat_history", JSON.stringify(history));
      updateUI();
    }

    function clearHistory() {
      history = [];
      localStorage.removeItem("baccarat_history");
      updateUI();
    }

    function aiPredict(history) {
      if (history.length < 3) return { prediction: "ç„¡", confidence: 0 };
      const last3 = history.slice(-3);
      if (last3.every(r => r === 'B')) return { prediction: "é–’", confidence: 0.7 };
      if (last3.every(r => r === 'P')) return { prediction: "èŠ", confidence: 0.65 };
      return { prediction: "ç„¡æ˜é¡¯è¶¨å‹¢", confidence: 0.5 };
    }

    function updateUI() {
      const last10 = history.slice(-10);
      const bCount = last10.filter(r => r === 'B').length;
      const pCount = last10.filter(r => r === 'P').length;
      const total = bCount + pCount;
      const bRate = total ? (bCount / total * 100).toFixed(1) : 0;
      const pRate = total ? (pCount / total * 100).toFixed(1) : 0;

      document.getElementById("stats").innerText = `å‹ç‡ï¼šèŠ ${bRate}% | é–’ ${pRate}%`;
      document.getElementById("suggestion").innerText = total === 0 ? "å»ºè­°ï¼šè«‹è¼¸å…¥çµæœ" :
        (bRate > pRate ? "å»ºè­°ï¼šæŠ¼èŠ" : "å»ºè­°ï¼šæŠ¼é–’");

      let streak = 1;
      for (let i = history.length - 2; i >= 0; i--) {
        if (history[i] === history[history.length - 1]) streak++;
        else break;
      }
      if (streak >= 3) {
        const name = history[history.length - 1] === "B" ? "èŠ" : "é–’";
        document.getElementById("streak").innerText = `ğŸ¯ é•·é¾è­¦å‘Šï¼š${name} é€£å‡º ${streak} æ¬¡`;
      } else {
        document.getElementById("streak").innerText = "";
      }

      // AI é æ¸¬
      const prediction = aiPredict(history);
      document.getElementById("ai-predict").innerText = `AI é æ¸¬ï¼š${prediction.prediction}ï¼ˆä¿¡å¿ƒå€¼ï¼š${Math.round(prediction.confidence * 100)}%ï¼‰`;

      // æ›´æ–°åœ–è¡¨
      chart.data.datasets[0].data = [bRate, pRate];
      chart.update();

      // æ›´æ–°æ­·å²ç´€éŒ„åˆ—è¡¨
      const list = document.getElementById("record-list");
      list.innerHTML = "";
      history.forEach((r, idx) => {
        const item = document.createElement("div");
        item.className = "history-item";
        item.innerText = `ç¬¬ ${idx + 1} å±€ï¼š${r === "B" ? "èŠ" : "é–’"}`;
        list.appendChild(item);
      });
    }

    const ctx = document.getElementById("resultChart").getContext("2d");
    const chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['èŠ', 'é–’'],
        datasets: [{
          label: 'å‹ç‡ %',
          data: [0, 0],
          backgroundColor: ['#f44336', '#2196f3']
        }]
      },
      options: {
        scales: {
          y: { beginAtZero: true, max: 100 }
        }
      }
    });

    updateUI();
  </script>
</body>
</html>
